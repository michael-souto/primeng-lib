<div class="card">
  <div class="w-full" *ngIf="!controller.hasData">
    <div
      class="surface-ground flex align-items-center justify-content-center m-5"
    >
      <div
        class="surface-card py-7 px-5 sm:px-7 shadow-2 flex flex-column w-full"
        style="border-radius: 14px"
      >
        <h1 class="font-bold text-2xl mt-0 mb-2">
          {{ "NOT_FOUND_REPORT.TITLE" | translate }}
        </h1>
        <p class="text-color-secondary mb-4">
          {{ "NOT_FOUND_REPORT.DESCRIPTION" | translate }}
        </p>
        <button
          pButton
          pRipple
          label="{{ 'NOT_FOUND_REPORT.CHANGE_FILTER' | translate }}"
          class="mt-4"
          (click)="controller.goToFilters()"
        ></button>
      </div>
    </div>
  </div>
  <div class="grid" #pdfConten *ngIf="controller.hasData">
    <div
      *ngFor="let session of controller.report?.sessions"
      class="{{ getNumberCols(session) }}"
    >
      <p-table
        *ngIf="session.type === 'TABLE_COLUMN'"
        [columns]="session?.headers"
        [resizableColumns]="true"
        [value]="session?.data"
        styleClass="p-datatable-gridlines"
        columnResizeMode="expand"
        [tableStyle]="{ width: '100%' }"
        [paginator]="true"
        [rows]="20"
        [rowsPerPageOptions]="[5, 10, 20, 50, 100]"
      >
        <ng-template pTemplate="caption">
          <div class="flex justify-content-between align-items-center">
            <h4 class="m-0">{{ session.title }}</h4>
            <button
              pButton
              pRipple
              type="button"
              icon="pi pi-file-excel"
              (click)="exportToExcel(session)"
              class="p-button-success p-button-sm"
              pTooltip="Exportar para Excel"
              tooltipPosition="top"
            ></button>
          </div>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th *ngFor="let col of columns" style="min-width: 300px">
              {{ col.header }}
              <p-tag *ngIf="col.dataSet" [value]="col.dataSet" />
            </th>
          </tr>
          <tr>
            <th *ngFor="let col of columns">
              <p-columnFilter
                type="text"
                [matchMode]="'contains'"
                [field]="col.field"
                [placeholder]="col.header"
                [ariaLabel]="col.header"
              />
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns">
          <tr>
            <td *ngFor="let col of columns">
              <span *ngIf="col.type === 'DATE'">{{
                rowData[col.field] | date : "dd/MM/yyyy"
              }}</span>
              <span *ngIf="col.type !== 'DATE'">{{ rowData[col.field] }}</span>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="summary">
          Total de {{ session.data.length }} registros
        </ng-template>
      </p-table>

      <d-chart-radial-bar
        *ngIf="session.type === 'CHART_DONUT'"
        [title]="session.title"
        [data]="getItemDashboardBySession(session)"
      ></d-chart-radial-bar>

      <d-chart-column
        *ngIf="session.type === 'CHART_VERTICAL_BAR'"
        [title]="session.title"
        [subtitle]="session.description"
        [data]="getItemDashboardBySession(session)"
      >
      </d-chart-column>

      <d-chart-bar
        *ngIf="session.type === 'CHART_HORIZONTAL_BAR'"
        [title]="session.title"
        [data]="getItemDashboardBySession(session)"
      >
      </d-chart-bar>

      <d-chart-line
        *ngIf="session.type === 'CHART_LINE'"
        [title]="session.title"
        [subtitle]="session.description"
        [showSum]="false"
        [data]="getItemDashboardBySession(session)"
      >
      </d-chart-line>

      <d-chart-treemap
        *ngIf="session.type === 'CHART_TREEMAP'"
        [title]="session.title"
        [data]="getItemDashboardBySession(session)"
      >
      </d-chart-treemap>

      <d-indicator-card
        *ngIf="session.type === 'INDICATOR_CARD'"
        [title]="session.title"
        [data]="getItemDashboardBySession(session)"
        [showSum]="false"
      >
      </d-indicator-card>

      <d-multi-indicator-card
        *ngIf="session.type === 'INDICATOR_CARD_MULTIPLE'"
        [title]="session.title"
        [data]="getItemDashboardBySession(session)"
        [showSum]="false"
      >
      </d-multi-indicator-card>
    </div>
    <p-scrollTop
      target="parent"
      styleClass="custom-scrolltop"
      [threshold]="100"
      icon="pi pi-arrow-up"
    />
  </div>

  <p-toolbar *ngIf="controller.report?.sessions.length > 0">
    <div class="p-toolbar-group-start">
      <button
        *ngIf="controller.framework.utils.isDesktop()"
        pButton
        pRipple
        icon="fas fa-chevron-left"
        [raised]="true"
        label="Voltar"
        class="w-auto mr-4 mt-4"
        (click)="controller.goToReport()"
      ></button>
    </div>
    <div class="p-toolbar-group-center"></div>
    <div class="p-toolbar-group-end"></div>
  </p-toolbar>
</div>
